<WithSearch
  @mapContextToProps={{map-context-to-props
    "current"
    "resultsPerPage"
    "totalPages"
    "setCurrent"
  }}
  @driver={{@driver}} as |state|
>
  {{#if @view}}
    {{#let (component (ensure-safe-component @view)) as |View|}}
      <View
        @current={{state.current}}
        @resultsPerPage={{state.resultsPerPage}}
        @totalPages={{state.totalPages}}
        @onChange={{state.setCurrent}}
        ...attributes
      />
    {{/let}}
  {{else}}
    {{yield
      (hash
        current=state.current
        resultsPerPage=state.resultsPerPage
        totalPages=state.totalPages
        onChange=state.setCurrent
      )
    }}
  {{/if}}
</WithSearch>